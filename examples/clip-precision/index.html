<!DOCTYPE html>
<meta charset="utf-8">
<style>

.A {
  fill: none;
  stroke-width: 1px;
  stroke: #727272;
  stroke-dasharray: 5, 5;
}

.B {
  fill: none;
  fill-opacity: 0.5;
  stroke: darkred;
  stroke-dasharray: 5, 5;
}

.intersection {
  fill-opacity: 0.5;
  stroke: #000;
  stroke-width: 2px;
}

</style>
<body>
<script src="https://d3js.org/d3-polygon.v0.2.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="../../build/partials.js"></script>
<script>

var svg,
    width = 960,
    height = 500,
    color,
    N = 100, vertices,
    triangles,
    clip, subject, intersection;

color = d3.scale.category10();

svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)

clip = [partials.polygon([[50, 50], [50, 450], [450, 450], [450, 50]])];

subject = [partials.polygon([[50, 50], [50, 450], [450, 450], [450, 50]])];

// subject.forEach(function(__) {
//   __.forEach(function(_, i) {
//     __[i] = _.map(function(d) {
//       return d + 1e-6 * Math.random() - 1/2 * 1e-6;
//     })
//   });
// });

intersection = partials.clipCollection(clip, subject);

svg.selectAll(".A")
    .data(clip.map(function(d) { return "M" + d.join("L") + "Z"; }), String)  
  .enter().append("path")
    .attr("class", "A")
    .attr("d", String);
    
svg.selectAll(".B")
    .data(subject.map(function(d) { return "M" + d.join("L") + "Z"; }), String)  
  .enter().append("path")
    .attr("class", "B")
    .attr("d", String);
    
svg.selectAll(".C")
  .data(intersection.map(function(d) { return "M" + d.join("L") + "Z"; }), String)  
.enter().append("path")
  .style("fill", function(d, i) { return color(i); })
  .attr("class", "intersection")
  .attr("d", String);

</script>