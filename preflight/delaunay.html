<!DOCTYPE html>
<meta charset="utf-8">
<style>

path {
  fill-opacity: 0.5;
  stroke: #727272;
}

.cut {
  stroke-width: 2px;
  stroke-dasharray: 5,5;
  stroke: #000;
}

.left {
  fill: #EB9394;
}

.right {
  fill: #8FBBDA;
}

</style>
<body>
<script src="../node_modules/d3-polygon/build/d3-polygon.js"></script>
<script src="../build/partials.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script><script>

var width = 960,
    height = 500,
    N = 25,
    triangles,
    polgyons;

var color = d3.scale.category10();

var a = [150, 250], b = [250, 500], c = [450, 300], d = [600, 400], e = [200, 175];

var vertices = [a, b, c, d, e];

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)

redraw();

function redraw() {
  var polygons = [];
  d3.selectAll("path").remove();

  var path = svg.selectAll(".base");

  var overlay = svg.selectAll(".overlay");

  triangles = d3.geom.delaunay(vertices);

  triangles.map(function(d, i) {
    var rectangle, square;
    rectangle = partials.triangle2Rectangle(d);
    square = partials.rectangle2Square(rectangle).map((d) => d.accumulate());
    // square = partials.rectangle2Square(rectangle)
    square.forEach(function(d) {
      d.i = i;
    });
    [].push.apply(polygons, square);
  });

  path = path.data(polygons.map(function(d) { return "M" + d.join("L") + "Z"; }), String);
  path.enter().append("path")
    .attr("d", String)
    .attr("fill", function(d, i) {return color(polygons[i].i); });
}

</script>